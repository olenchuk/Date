use Test::More qw(no_plan);
use Date::Range;

my $ref_date = '2016-12-28';
my $dr = Date::Range->new(today_date => $ref_date, type => 'week');
while (my $line = <main::DATA>) {
    chomp $line;
    my ($day,$intervals,$span,$sliding_window,$direction,$start,$end,$last) = split /,/,$line;
    $dr->set_start_dow($day);
    $dr->set_direction($direction);
    $dr->set_sliding_window($sliding_window);
    $dr->set_span($span);
    $dr->set_intervals($intervals);
    my ($first_date,$end_date,$last_date) = $dr->get_dates;
    cmp_ok($first_date,'eq',$start,"D=$day | I=$intervals | S=$span | W=$sliding_window | D=$direction | START");
    cmp_ok($end_date,'eq',$end,"D=$day | I=$intervals | S=$span | W=$sliding_window | D=$direction | END");
    cmp_ok($last_date,'eq',$last,"D=$day | I=$intervals | S=$span | W=$sliding_window | D=$direction | LAST");
}

#foreach my $day (qw(Monday Tuesday Wednesday Thursday Friday Saturday Sunday)) {
#    foreach my $direction (0) {
#        foreach my $sliding_window (0,1) {
#            foreach my $span (1,5) {
#                foreach my $intervals (-3..3) {
#                    next if $sliding_window == 1 and $span == 1;
#                    $dr->set_start_dow($day);
#                    $dr->set_direction($direction);
#                    $dr->set_sliding_window($sliding_window);
#                    $dr->set_span($span);
#                    $dr->set_intervals($intervals);
#                    my $atts = "D=$day | I=$intervals | S=$span | W=$sliding_window | D=$direction";
#                    my ($start,$end,$last) = $dr->get_dates();
#                    my $out = "$day,$intervals,$span,$sliding_window,$direction,$start,$end,$last";
#                    print "$out\n";
#                }
#            }
#        }
#    }
#}

__END__
Monday,-3,1,0,-,2017-01-16,2017-01-23,2017-01-22
Monday,-2,1,0,-,2017-01-09,2017-01-16,2017-01-15
Monday,-1,1,0,-,2017-01-02,2017-01-09,2017-01-08
Monday,0,1,0,-,2016-12-26,2017-01-02,2017-01-01
Monday,1,1,0,-,2016-12-19,2016-12-26,2016-12-25
Monday,2,1,0,-,2016-12-12,2016-12-19,2016-12-18
Monday,3,1,0,-,2016-12-05,2016-12-12,2016-12-11
Monday,-3,5,0,-,2017-04-10,2017-05-15,2017-05-14
Monday,-2,5,0,-,2017-03-06,2017-04-10,2017-04-09
Monday,-1,5,0,-,2017-01-30,2017-03-06,2017-03-05
Monday,0,5,0,-,2016-12-26,2017-01-30,2017-01-29
Monday,1,5,0,-,2016-11-21,2016-12-26,2016-12-25
Monday,2,5,0,-,2016-10-17,2016-11-21,2016-11-20
Monday,3,5,0,-,2016-09-12,2016-10-17,2016-10-16
Monday,-3,5,1,-,2016-12-19,2017-01-23,2017-01-22
Monday,-2,5,1,-,2016-12-12,2017-01-16,2017-01-15
Monday,-1,5,1,-,2016-12-05,2017-01-09,2017-01-08
Monday,0,5,1,-,2016-11-28,2017-01-02,2017-01-01
Monday,1,5,1,-,2016-11-21,2016-12-26,2016-12-25
Monday,2,5,1,-,2016-11-14,2016-12-19,2016-12-18
Monday,3,5,1,-,2016-11-07,2016-12-12,2016-12-11
Tuesday,-3,1,0,-,2017-01-17,2017-01-24,2017-01-23
Tuesday,-2,1,0,-,2017-01-10,2017-01-17,2017-01-16
Tuesday,-1,1,0,-,2017-01-03,2017-01-10,2017-01-09
Tuesday,0,1,0,-,2016-12-27,2017-01-03,2017-01-02
Tuesday,1,1,0,-,2016-12-20,2016-12-27,2016-12-26
Tuesday,2,1,0,-,2016-12-13,2016-12-20,2016-12-19
Tuesday,3,1,0,-,2016-12-06,2016-12-13,2016-12-12
Tuesday,-3,5,0,-,2017-04-11,2017-05-16,2017-05-15
Tuesday,-2,5,0,-,2017-03-07,2017-04-11,2017-04-10
Tuesday,-1,5,0,-,2017-01-31,2017-03-07,2017-03-06
Tuesday,0,5,0,-,2016-12-27,2017-01-31,2017-01-30
Tuesday,1,5,0,-,2016-11-22,2016-12-27,2016-12-26
Tuesday,2,5,0,-,2016-10-18,2016-11-22,2016-11-21
Tuesday,3,5,0,-,2016-09-13,2016-10-18,2016-10-17
Tuesday,-3,5,1,-,2016-12-20,2017-01-24,2017-01-23
Tuesday,-2,5,1,-,2016-12-13,2017-01-17,2017-01-16
Tuesday,-1,5,1,-,2016-12-06,2017-01-10,2017-01-09
Tuesday,0,5,1,-,2016-11-29,2017-01-03,2017-01-02
Tuesday,1,5,1,-,2016-11-22,2016-12-27,2016-12-26
Tuesday,2,5,1,-,2016-11-15,2016-12-20,2016-12-19
Tuesday,3,5,1,-,2016-11-08,2016-12-13,2016-12-12
Wednesday,-3,1,0,-,2017-01-18,2017-01-25,2017-01-24
Wednesday,-2,1,0,-,2017-01-11,2017-01-18,2017-01-17
Wednesday,-1,1,0,-,2017-01-04,2017-01-11,2017-01-10
Wednesday,0,1,0,-,2016-12-28,2017-01-04,2017-01-03
Wednesday,1,1,0,-,2016-12-21,2016-12-28,2016-12-27
Wednesday,2,1,0,-,2016-12-14,2016-12-21,2016-12-20
Wednesday,3,1,0,-,2016-12-07,2016-12-14,2016-12-13
Wednesday,-3,5,0,-,2017-04-12,2017-05-17,2017-05-16
Wednesday,-2,5,0,-,2017-03-08,2017-04-12,2017-04-11
Wednesday,-1,5,0,-,2017-02-01,2017-03-08,2017-03-07
Wednesday,0,5,0,-,2016-12-28,2017-02-01,2017-01-31
Wednesday,1,5,0,-,2016-11-23,2016-12-28,2016-12-27
Wednesday,2,5,0,-,2016-10-19,2016-11-23,2016-11-22
Wednesday,3,5,0,-,2016-09-14,2016-10-19,2016-10-18
Wednesday,-3,5,1,-,2016-12-21,2017-01-25,2017-01-24
Wednesday,-2,5,1,-,2016-12-14,2017-01-18,2017-01-17
Wednesday,-1,5,1,-,2016-12-07,2017-01-11,2017-01-10
Wednesday,0,5,1,-,2016-11-30,2017-01-04,2017-01-03
Wednesday,1,5,1,-,2016-11-23,2016-12-28,2016-12-27
Wednesday,2,5,1,-,2016-11-16,2016-12-21,2016-12-20
Wednesday,3,5,1,-,2016-11-09,2016-12-14,2016-12-13
Thursday,-3,1,0,-,2017-01-12,2017-01-19,2017-01-18
Thursday,-2,1,0,-,2017-01-05,2017-01-12,2017-01-11
Thursday,-1,1,0,-,2016-12-29,2017-01-05,2017-01-04
Thursday,0,1,0,-,2016-12-22,2016-12-29,2016-12-28
Thursday,1,1,0,-,2016-12-15,2016-12-22,2016-12-21
Thursday,2,1,0,-,2016-12-08,2016-12-15,2016-12-14
Thursday,3,1,0,-,2016-12-01,2016-12-08,2016-12-07
Thursday,-3,5,0,-,2017-04-06,2017-05-11,2017-05-10
Thursday,-2,5,0,-,2017-03-02,2017-04-06,2017-04-05
Thursday,-1,5,0,-,2017-01-26,2017-03-02,2017-03-01
Thursday,0,5,0,-,2016-12-22,2017-01-26,2017-01-25
Thursday,1,5,0,-,2016-11-17,2016-12-22,2016-12-21
Thursday,2,5,0,-,2016-10-13,2016-11-17,2016-11-16
Thursday,3,5,0,-,2016-09-08,2016-10-13,2016-10-12
Thursday,-3,5,1,-,2016-12-15,2017-01-19,2017-01-18
Thursday,-2,5,1,-,2016-12-08,2017-01-12,2017-01-11
Thursday,-1,5,1,-,2016-12-01,2017-01-05,2017-01-04
Thursday,0,5,1,-,2016-11-24,2016-12-29,2016-12-28
Thursday,1,5,1,-,2016-11-17,2016-12-22,2016-12-21
Thursday,2,5,1,-,2016-11-10,2016-12-15,2016-12-14
Thursday,3,5,1,-,2016-11-03,2016-12-08,2016-12-07
Friday,-3,1,0,-,2017-01-13,2017-01-20,2017-01-19
Friday,-2,1,0,-,2017-01-06,2017-01-13,2017-01-12
Friday,-1,1,0,-,2016-12-30,2017-01-06,2017-01-05
Friday,0,1,0,-,2016-12-23,2016-12-30,2016-12-29
Friday,1,1,0,-,2016-12-16,2016-12-23,2016-12-22
Friday,2,1,0,-,2016-12-09,2016-12-16,2016-12-15
Friday,3,1,0,-,2016-12-02,2016-12-09,2016-12-08
Friday,-3,5,0,-,2017-04-07,2017-05-12,2017-05-11
Friday,-2,5,0,-,2017-03-03,2017-04-07,2017-04-06
Friday,-1,5,0,-,2017-01-27,2017-03-03,2017-03-02
Friday,0,5,0,-,2016-12-23,2017-01-27,2017-01-26
Friday,1,5,0,-,2016-11-18,2016-12-23,2016-12-22
Friday,2,5,0,-,2016-10-14,2016-11-18,2016-11-17
Friday,3,5,0,-,2016-09-09,2016-10-14,2016-10-13
Friday,-3,5,1,-,2016-12-16,2017-01-20,2017-01-19
Friday,-2,5,1,-,2016-12-09,2017-01-13,2017-01-12
Friday,-1,5,1,-,2016-12-02,2017-01-06,2017-01-05
Friday,0,5,1,-,2016-11-25,2016-12-30,2016-12-29
Friday,1,5,1,-,2016-11-18,2016-12-23,2016-12-22
Friday,2,5,1,-,2016-11-11,2016-12-16,2016-12-15
Friday,3,5,1,-,2016-11-04,2016-12-09,2016-12-08
Saturday,-3,1,0,-,2017-01-14,2017-01-21,2017-01-20
Saturday,-2,1,0,-,2017-01-07,2017-01-14,2017-01-13
Saturday,-1,1,0,-,2016-12-31,2017-01-07,2017-01-06
Saturday,0,1,0,-,2016-12-24,2016-12-31,2016-12-30
Saturday,1,1,0,-,2016-12-17,2016-12-24,2016-12-23
Saturday,2,1,0,-,2016-12-10,2016-12-17,2016-12-16
Saturday,3,1,0,-,2016-12-03,2016-12-10,2016-12-09
Saturday,-3,5,0,-,2017-04-08,2017-05-13,2017-05-12
Saturday,-2,5,0,-,2017-03-04,2017-04-08,2017-04-07
Saturday,-1,5,0,-,2017-01-28,2017-03-04,2017-03-03
Saturday,0,5,0,-,2016-12-24,2017-01-28,2017-01-27
Saturday,1,5,0,-,2016-11-19,2016-12-24,2016-12-23
Saturday,2,5,0,-,2016-10-15,2016-11-19,2016-11-18
Saturday,3,5,0,-,2016-09-10,2016-10-15,2016-10-14
Saturday,-3,5,1,-,2016-12-17,2017-01-21,2017-01-20
Saturday,-2,5,1,-,2016-12-10,2017-01-14,2017-01-13
Saturday,-1,5,1,-,2016-12-03,2017-01-07,2017-01-06
Saturday,0,5,1,-,2016-11-26,2016-12-31,2016-12-30
Saturday,1,5,1,-,2016-11-19,2016-12-24,2016-12-23
Saturday,2,5,1,-,2016-11-12,2016-12-17,2016-12-16
Saturday,3,5,1,-,2016-11-05,2016-12-10,2016-12-09
Sunday,-3,1,0,-,2017-01-15,2017-01-22,2017-01-21
Sunday,-2,1,0,-,2017-01-08,2017-01-15,2017-01-14
Sunday,-1,1,0,-,2017-01-01,2017-01-08,2017-01-07
Sunday,0,1,0,-,2016-12-25,2017-01-01,2016-12-31
Sunday,1,1,0,-,2016-12-18,2016-12-25,2016-12-24
Sunday,2,1,0,-,2016-12-11,2016-12-18,2016-12-17
Sunday,3,1,0,-,2016-12-04,2016-12-11,2016-12-10
Sunday,-3,5,0,-,2017-04-09,2017-05-14,2017-05-13
Sunday,-2,5,0,-,2017-03-05,2017-04-09,2017-04-08
Sunday,-1,5,0,-,2017-01-29,2017-03-05,2017-03-04
Sunday,0,5,0,-,2016-12-25,2017-01-29,2017-01-28
Sunday,1,5,0,-,2016-11-20,2016-12-25,2016-12-24
Sunday,2,5,0,-,2016-10-16,2016-11-20,2016-11-19
Sunday,3,5,0,-,2016-09-11,2016-10-16,2016-10-15
Sunday,-3,5,1,-,2016-12-18,2017-01-22,2017-01-21
Sunday,-2,5,1,-,2016-12-11,2017-01-15,2017-01-14
Sunday,-1,5,1,-,2016-12-04,2017-01-08,2017-01-07
Sunday,0,5,1,-,2016-11-27,2017-01-01,2016-12-31
Sunday,1,5,1,-,2016-11-20,2016-12-25,2016-12-24
Sunday,2,5,1,-,2016-11-13,2016-12-18,2016-12-17
Sunday,3,5,1,-,2016-11-06,2016-12-11,2016-12-10
